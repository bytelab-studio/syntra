# Schemas

Schemas play a crucial role in defining the structure of data exchanged in API routes, as shown in
the [Route Manager](./04-route-manager.md). OpenAPI specifications are required to fully define custom handlers. To
streamline this process, schemas can be defined and reused throughout your application.

## Table Schemas

Table schemas can be generated dynamically using the `SchemaDefinition.of` method. These schemas adapt to the context of
their usage, such as `select`, `update`, or `create`.

Example:

```typescript
import {Table, table, Column, VarChar, SchemaDefinition} from "@bytelab.studio/syntra-plugin";

@table()
class Book extends Table {
    public constructor() {
        super();
    }

    public name: Column<string> = new Column(new VarChar(100))
}

console.log(SchemaDefiniton.of(Book, "select"));
```

### Schema Perspectives

- `select`: Includes properties required for querying data, such as primary keys.
- `create`: Includes properties needed to create new records, excluding primary keys or autogenerated fields.
- `update`: Focuses on modifiable fields, often excluding primary keys or autogenerated fields.

## Define Schemas

Custom schemas can be defined using the `SchemaDefinition.define` method, which directly accepts a schema name and an OpenAPI Specification object.

Example:
```typescript
import {SchemaDefinition} from "@bytelab.studio/syntra-plugin";

const mySchema: SchemaDefinition = SchemaDefinition.define("MY_SCHEMA", {
    type: "object",
    property: {
        name: {
            type: "string"
        }
    }
});
```

## Referencing Schemas

Once defined, schemas can reference other schemas to build complex data structures.

Example:
```typescript
import {SchemaDefinition} from "@bytelab.studio/syntra.plugin";

const secondSchema: SchemaDefinition = SchemaDefinition.define("SECOND_SCHEMA", {
    type: "array",
    items: [
        {
            $ref: mySchema.location // Reference the previously defined schema
        }
    ]
});
```

## Schema Lookup

When a schema cannot be directly imported, use the `SchemaDefinition.from` method to create a reference to it.

```typescript
import {SchemaDefinition} from "@bytelab.studio/syntra.plugin";

const mySchema: SchemaDefinition = SchemaDefinition.from("#/components/schemas/MY_SCHEMA");
```